# 커널 I/O 서브시스템

커널 I/O 서브시스템은 운영체제의 핵심적인 부분으로, I/O 요청을 관리하고 처리하는 모든 서비스를 제공합니다. 이 서브시스템은 I/O 작업의 일관성, 보호, 스케줄링, 버퍼링, 캐싱을 책임집니다.

**1. I/O 스케줄링 (I/O Scheduling)**

커널은 여러 프로세스로부터 들어오는 I/O 요청의 순서를 결정하여 장치에 전달함으로써 효율성을 높입니다.

* 목표: 디스크와 같은 공유 I/O 장치의 처리량(Throughput)을 높이고, 응답 시간(Response Time)을 줄이는 것입니다.
* 구현: 요청들을 \*\*대기열(Queue)\*\*에 넣어 관리하며, 장치 특성(예: 디스크의 탐색 시간)을 고려하여 순서를 재배치합니다.
* 효과: I/O 요청이 몰릴 때, 공정성을 유지하면서도 최소한의 물리적 이동으로 최대의 작업을 처리할 수 있게 합니다.

**2. 버퍼링 (Buffering)**

버퍼링은 데이터가 한 장치에서 다른 장치로 전송되는 동안 임시 저장 공간인 버퍼를 사용하는 기술입니다.

* 속도 불일치 완화: 생산자와 소비자(예: 디스크와 CPU)의 속도 차이를 완충하여 효율적인 데이터 전송을 가능하게 합니다.
* 전송 크기 불일치 완화: 서로 다른 전송 단위(크기)를 사용하는 장치 간의 데이터 교환을 중재합니다.
* 데이터 복사 의미: 커널 버퍼링은 일반적으로 메인 메모리 내에서 데이터 블록을 한 영역에서 다른 영역으로 복사하는 작업을 포함합니다.

**3. 캐싱 (Caching)**

캐싱은 버퍼링과 유사하지만, 데이터의 복사본을 저장하여 이후의 접근 속도를 높이는 것이 주된 목적입니다.

* 블록 캐시 (Buffer Cache): 디스크 블록의 복사본을 메모리(RAM)에 보관하는 영역입니다.
* 페이지 캐시 (Page Cache): 운영체제의 가상 메모리 관리 시스템이 파일 데이터 블록을 캐시하는 영역입니다.
* 통합: 대부분의 최신 운영체제는 파일 시스템 데이터 캐싱을 페이지 캐시와 통합하여 관리합니다. 이로 인해 메모리 매핑 파일과 일반적인 파일 I/O가 동일한 캐시를 공유하여 일관성 유지 및 효율성이 증가합니다.

**4. 스풀링 및 보호 (Spooling and Protection)**

* 스풀링 (Spooling):
  * 원리: 출력이 느린 장치(예: 프린터)에 대한 작업을 디스크와 같은 고속 장치에 \*\*임시로 저장(Spool)\*\*해 두었다가, 장치가 준비될 때 순서대로 처리하는 방식입니다.
  * 효과: CPU와 응용 프로그램은 출력 작업 완료를 기다릴 필요 없이 즉시 다음 작업을 계속할 수 있습니다.
* 보호 (Protection):
  * 역할: I/O 하드웨어 및 커널 I/O 서브시스템에 대한 접근을 운영체제만 가능하도록 제한합니다.
  * 구현: 모든 I/O 명령은 \*\*특권 명령어(Privileged Instruction)\*\*로 지정되어 커널 모드에서만 실행될 수 있습니다. 응용 프로그램은 반드시 시스템 호출을 통해 커널에게 I/O 작업을 위임해야 합니다.

**5. 오류 처리 (Error Handling)**

커널 I/O 서브시스템은 I/O 장치에서 발생할 수 있는 오류를 감지하고 처리합니다.

* 감지: 하드웨어 오류(예: 디스크 불량 블록)를 장치 컨트롤러의 상태 레지스터를 통해 감지합니다.
* 복구: 오류가 발생하면 장치 드라이버는 해당 작업을 재시도하거나, 불량 블록을 재할당하는 등의 복구 메커니즘을 수행합니다. 복구가 불가능한 경우 응용 프로그램에 오류를 통보합니다.
