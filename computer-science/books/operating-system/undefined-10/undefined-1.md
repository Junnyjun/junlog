# 성능

I/O는 컴퓨터 시스템의 전반적인 성능에 가장 큰 병목 현상을 일으키는 요소 중 하나입니다. CPU의 명령 실행 속도는 나노초($$ $ns$ $$) 단위인 반면, 디스크 I/O는 밀리초($$ $ms$ $$) 단위로 수백만 배 이상의 속도 차이가 발생하기 때문입니다.

**I/O 성능 저하의 주요 원인**

운영체제가 I/O를 처리할 때 성능을 떨어뜨리는 핵심적인 물리적, 소프트웨어적 요인은 다음과 같습니다.

* 문맥 교환 (Context Switching): I/O 장치가 데이터를 준비할 때마다 발생하는 인터럽트는 CPU가 현재 작업을 멈추고 커널 모드로 전환하게 만들며, 이는 상당한 계산 자원을 소모합니다.
* 데이터 복사 (Data Copying): 데이터가 하드웨어 컨트롤러에서 커널 버퍼로, 다시 커널 버퍼에서 사용자 프로세스의 메모리 영역으로 복사되는 과정은 CPU와 메모리 대역폭을 낭비하게 합니다.
* 커널 소프트웨어 오버헤드: 장치 드라이버를 통과하고, 인터럽트를 처리하며, 장치 대기열을 관리하는 등 커널 내부의 복잡한 경로를 거치는 과정 자체가 성능 부담이 됩니다.

**I/O 성능 최적화 기법**

운영체제는 이러한 오버헤드를 최소화하기 위해 하드웨어와 소프트웨어 양면에서 다양한 기법을 동원합니다.

* 인터럽트 빈도 감소:
  * 고속 네트워크 인터페이스 등에서 데이터가 쏟아질 때, 매 패킷마다 인터럽트를 거는 대신 폴링(Polling) 방식을 일시적으로 혼합하여 CPU의 인터럽트 처리 부담을 줄입니다.
  * 여러 개의 데이터 전송 완료를 하나의 인터럽트로 묶어 통보하는 인터럽트 병합(Interrupt Coalescing) 기술을 사용합니다.
* DMA(Direct Memory Access)의 극대화:
  * 대량의 데이터 전송 시 CPU를 완전히 배제하고 DMA 컨트롤러가 메모리와 장치 간 전송을 전담하게 하여 CPU가 다른 연산에 집중할 수 있도록 합니다.
* 스마트 컨트롤러 도입:
  * I/O 컨트롤러 자체에 마이크로프로세서를 탑재하여 CPU가 수행하던 스케줄링이나 간단한 데이터 무결성 검사 기능을 장치단에서 직접 처리하게 합니다.
* 복사 횟수 최소화 (Zero-copy):
  * 커널과 사용자 영역 사이의 불필요한 복사를 줄이기 위해 가상 메모리 매핑 기술을 활용하여 데이터를 직접 전달하는 기법을 적용합니다.
* 비동기 I/O 활용:
  * 프로세스가 I/O 완료를 기다리며 차단(Blocking)되지 않고 다른 작업을 동시에 수행할 수 있도록 비동기식 인터페이스를 제공하여 시스템 전체의 처리량을 높입니다.

**성능 개선을 위한 하드웨어적 접근**

최신 시스템에서는 소프트웨어적인 노력 외에도 하드웨어 아키텍처를 개선하여 성능을 높입니다.

* 고속 전송 인터페이스: PCIe(PCI Express)와 같은 병렬 및 직렬 결합 버스 인터페이스를 통해 초당 수십 기가바이트의 전송 대역폭을 확보합니다.
* 전용 I/O 프로세서: 메인 CPU의 업무를 덜어주기 위해 I/O 작업만 전담하여 처리하는 특수 프로세서를 시스템에 배치하기도 합니다.
