# 디렉터리 구조

디렉터리는 파일 시스템 내의 수많은 파일을 효율적으로 조직화하고 관리하기 위한 일종의 심볼 테이블입니다. 운영체제는 디렉터리를 통해 파일의 이름을 물리적인 위치와 연결합니다.

**디렉터리의 기능 및 연산**

디렉터리 시스템은 사용자에게 다음과 같은 필수적인 기능을 제공해야 합니다.

* 파일 찾기 (Search for a file): 특정 패턴이나 이름을 가진 파일을 신속하게 검색합니다.
* 파일 생성 (Create a file): 새로운 파일을 만들고 이를 디렉터리에 등록합니다.
* 파일 삭제 (Delete a file): 파일이 더 이상 필요 없을 때 디렉터리에서 해당 항목을 제거합니다.
* 디렉터리 나열 (List a directory): 디렉터리에 포함된 모든 파일 목록과 그 속성을 보여줍니다.
* 파일 재명명 (Rename a file): 파일의 이름을 변경하여 조직 구조를 갱신합니다.
* 파일 시스템 순회 (Traverse the file system): 전체 디렉터리 구조를 따라가며 파일들을 백업하거나 검사합니다.

**1단계 디렉터리 (Single-Level Directory)**

모든 파일이 하나의 디렉터리 안에 존재하는 가장 단순한 형태입니다.

* 특징: 모든 사용자가 같은 디렉터리를 공유합니다.
* 장점: 구현이 매우 간단하고 관리가 쉽습니다.
* 단점: 파일 수가 많아지면 관리가 어렵고, \*\*파일 이름 충돌(Naming Problem)\*\*이 발생합니다. 서로 다른 사용자가 같은 이름의 파일을 만들 수 없습니다.

**2단계 디렉터리 (Two-Level Directory)**

각 사용자마다 별도의 \*\*사용자 파일 디렉터리(UFD)\*\*를 할당하는 방식입니다.

* 구성: 시스템 전체를 관리하는 \*\*마스터 파일 디렉터리(MFD)\*\*가 각 사용자의 UFD를 가리킵니다.
* 장점: 서로 다른 사용자가 같은 파일 이름을 사용할 수 있어 이름 충돌 문제를 해결합니다.
* 단점: 사용자 간의 파일 공유가 어렵고, 한 사용자가 파일을 논리적으로 분류(예: 프로젝트별 폴더 생성)할 수 없습니다.

**트리 구조 디렉터리 (Tree-Structured Directories)**

현대 운영체제에서 가장 널리 사용되는 방식으로, 디렉터리가 다시 하위 디렉터리를 가질 수 있는 계층적 구조입니다.

* 경로명 (Path Name): 루트부터 특정 파일까지의 경로를 나타내며, 절대 경로와 \*\*상대 경로(현재 작업 디렉터리 기준)\*\*로 나뉩니다.
* 장점: 사용자가 파일을 임의의 그룹으로 조직화할 수 있어 매우 효율적입니다.
* 파일 삭제 정책: 디렉터리를 삭제할 때 내부의 파일까지 모두 지울 것인지(Recursive), 비어있는 디렉터리만 지울 것인지 결정해야 합니다.

**비순환 그래프 디렉터리 (Acyclic-Graph Directories)**

트리 구조를 확장하여, 하나의 파일이나 디렉터리가 여러 개의 부모 디렉터리에 동시에 소속될 수 있게 허용하는 구조입니다.

* 공유 (Sharing): 링크(Link)라는 개념을 통해 동일한 파일을 다른 이름이나 경로로 접근할 수 있습니다.
* 일관성 문제: 공유된 파일을 수정하면 이를 참조하는 모든 경로에서 수정 내용이 반영됩니다.
* 복잡성: 파일을 삭제할 때, 단순히 엔트리를 지우는 것이 아니라 실제 데이터를 언제 지울지 결정하기 위해 \*\*참조 횟수(Reference Count)\*\*를 관리해야 합니다.

**일반 그래프 디렉터리 (General Graph Directory)**

비순환 그래프에서 제약을 없애, 디렉터리 구조 내에 \*\*순환(Cycle)\*\*이 발생하는 것을 허용하거나 방지하지 않는 구조입니다.

* 문제점: 무한 루프에 빠질 수 있어 파일 검색이나 시스템 전체 순회가 매우 어렵습니다.
* 가비지 컬렉션 (Garbage Collection): 순환 구조 때문에 더 이상 사용되지 않는 공간을 찾는 작업이 매우 복잡해지며, 시스템 자원을 많이 소모합니다.
* 해결책: 링크를 생성할 때 순환이 발생하는지 매번 검사하거나, 하위 디렉터리로의 링크(Back pointer) 생성을 엄격히 제한합니다.
