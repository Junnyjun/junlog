# ACK

ACK (Acknowledgment) 신호는 네트워크 통신에서 신뢰성을 보장하는 핵심 요소입니다. 이 신호는 긍정적 확인(Positive ACK)과 부정적 확인(Negative ACK, NACK)으로 나눌 수 있습니다.

***

#### 1. 긍정적 확인 (Positive ACK)

Positive ACK는 수신자가 송신자에게 데이터 패킷을 성공적으로 잘 받았다고 알려주는 긍정적인 응답입니다. 만약 송신자가 특정 시간 내에 ACK를 받지 못하면, 해당 패킷을 다시 보냅니다. 이는 TCP(Transmission Control Protocol)와 같이 일대일(Unicast) 통신에서 주로 사용됩니다.

**1.1 지연 ACK (Delayed ACK)**

수신자는 모든 패킷에 대해 즉시 ACK를 보낼 필요가 없습니다. 데이터를 보내는 방향과 ACK를 보내는 방향이 같을 경우, ACK를 잠시 지연시켰다가 다음에 보낼 데이터에 ACK를 함께 실어 보낼 수 있습니다. 이를 \*\*피기백(piggybacking)\*\*이라고 합니다. 예를 들어, 텔넷(Telnet)과 같은 상호작용성(interactive)이 높은 통신에서, 키보드 입력에 대한 ACK를 즉시 보내는 대신, 서버가 입력 내용을 처리한 후 다시 보내는 응답 데이터에 ACK를 함께 담아 효율성을 높입니다.

**1.2 누적 ACK (Cumulative ACK)**

TCP의 슬라이딩 윈도우(Sliding Window) 프로토콜을 사용하면, 송신자는 여러 패킷을 한꺼번에 보내고 하나의 ACK를 기다릴 수 있습니다. 예를 들어, 송신자가 10개의 패킷을 연속으로 보냈을 때, 수신자는 첫 번째 패킷에 대한 ACK를 보내는 대신, 10개 패킷 전체에 대해 하나의 누적 ACK를 보내는 방식입니다. 이는 대량 데이터 전송(예: FTP)에서 효율적입니다.

**1.3 선택적 ACK (Selective ACK, SACK)**

누적 ACK는 중간에 패킷이 손실되었을 때 비효율적일 수 있습니다. 예를 들어, 10개의 패킷 중 3번 패킷만 유실된 경우, 누적 ACK는 1, 2번 패킷만 받았다고 알립니다. 이 경우 송신자는 유실된 3번 패킷뿐 아니라 4\~10번 패킷까지 모두 다시 보내게 됩니다.

SACK는 이 문제를 해결합니다. TCP 연결을 시작할 때 SACK 기능을 활성화하면, 수신자는 유실된 패킷 외에 정상적으로 받은 패킷의 범위를 송신자에게 알려줍니다. 위 예시의 경우, 수신자는 "1, 2번 패킷을 받았고, 4\~10번 패킷도 받았습니다. 3번 패킷이 유실되었습니다"라고 알려주어, 송신자가 3번 패킷만 재전송하도록 합니다.

***

#### 2. 부정적 확인 (Negative ACK, NACK)

NACK는 수신자가 패킷이 유실되었음을 감지했을 때 보내는 부정적인 응답입니다. NACK는 멀티캐스트(Multicast) 통신처럼 수신자가 많은 환경에서 특히 유용합니다.

멀티캐스트는 하나의 송신자가 여러 수신자에게 동시에 데이터를 보내는 방식입니다. 만약 모든 수신자가 받은 패킷에 대해 ACK를 보내게 되면, 송신자는 수많은 ACK를 동시에 받게 되어 네트워크에 과부하가 걸리는 ACK 임플로전(Implosion) 현상이 발생할 수 있습니다.

NACK는 이 문제를 해결합니다.

* NACK 전송: 수신자는 패킷이 유실되었을 때만 송신자에게 NACK를 보냅니다.
* 유니캐스트/멀티캐스트: NACK는 특정 수신자에게만 유실된 패킷을 재전송하도록 요청하는 유니캐스트(unicast) 메시지로 보낼 수도 있고, 다른 수신자들도 동일한 패킷을 유실했을 가능성을 고려하여 멀티캐스트(multicast) 메시지로 보낼 수도 있습니다.

NACK 임플로전 방지: 여러 수신자가 동시에 NACK를 보내는 것을 막기 위해, NACK를 보내기 전에 무작위로 지연 시간을 두어 다른 수신자가 먼저 NACK를 보내면 자신은 NACK를 보내지 않도록 할 수 있습니다.

***

#### 3. 요약

| 구분    | 긍정적 확인 (ACK)            | 부정적 확인 (NACK)                     |
| ----- | ----------------------- | --------------------------------- |
| 목적    | 패킷 성공적 수신 확인            | 패킷 유실 통지                          |
| 사용 환경 | 주로 일대일(Unicast) 통신      | 주로 일대다(Multicast) 통신              |
| 장점    | 신뢰성 보장, 데이터 무결성 유지      | 높은 확장성, ACK 임플로전 방지               |
| 종류    | 지연 ACK, 누적 ACK, 선택적 ACK | NACK                              |
| 프로토콜  | TCP                     | UDP 기반의 특정 프로토콜\<br>(DDS의 RTPS 등) |
