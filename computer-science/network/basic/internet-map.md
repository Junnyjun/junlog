# Internet Map

인터넷은 전 세계의 수많은 네트워크가 연결된 거대한 인프라로, 각기 다른 규모와 특성을 가진 네트워크들이 상호 작용하여 하나의 거대한 "인터넷 지도"를 형성합니다.&#x20;

이러한 인터넷의 구조를 이해하기 위해서는 **자율 시스템(Autonomous System, AS)**, **경계 게이트웨이 프로토콜(Border Gateway Protocol, BGP)**, 그리고 인터넷 익스체인지 포인트(Internet Exchange Point, IXP)의 개념을 깊이 있게 살펴볼 필요가 있습니다.&#x20;

### **자율 시스템(AS)**

자율 시스템(AS)은 단일 행정 관리 하에서 운영되는 하나 이상의 IP 네트워크의 집합으로, 공통의 라우팅 정책을 사용하여 외부 네트워크와 통신합니다.&#x20;

AS는 인터넷 상에서 독립된 라우팅 도메인으로 간주되며, 각 AS는 고유한 AS 번호(Autonomous System Number, ASN)를 부여받습니다. 이러한 AS들은 인터넷의 구성 요소로서 서로 연결되어 복잡한 네트워크의 지도를 형성합니다.

#### **AS의 역할**

**라우팅 정책의 자율성 보장**: 각 AS는 자체적인 라우팅 정책을 수립하고 운영합니다. 이는 네트워크 운영자가 자신들의 트래픽 경로를 제어하고 최적화할 수 있도록 합니다.

**인터넷 규모의 라우팅 관리**: AS 간의 라우팅을 통해 글로벌 인터넷이 연결됩니다. 이는 인터넷의 분산된 구조를 가능하게 합니다.

**경로 선택과 최적화**: AS는 BGP를 통해 다른 AS와 경로 정보를 교환하여 최적의 경로를 결정합니다.

#### **AS 번호(ASN)**

ASN은 AS를 고유하게 식별하는 16비트 또는 32비트 숫자입니다. 인터넷 할당 번호 권한(IANA)에서 관리하며, 지역 인터넷 등록 기관(RIR)을 통해 인터넷 서비스 제공자(ISP)나 대규모 조직에 할당됩니다. ASN은 두 가지로 분류됩니다

* **공용 ASN**: 인터넷 상에서 공개적으로 사용되며, 글로벌 라우팅에 참여합니다.
* **사설 ASN**: 내부 네트워크에서 사용되며, 인터넷 상에서 공개되지 않습니다.

***

### **경계 게이트웨이 프로토콜(BGP)**

BGP는 AS 간의 라우팅 정보를 교환하기 위한 **인터넷의 표준 외부 게이트웨이 프로토콜**입니다. 인터넷의 "백본(backbone)"으로 불리며, 전 세계의 네트워크를 연결하고 경로 선택을 관리하는 핵심 프로토콜입니다.

#### **BGP의 역할과 기능**

* **경로 정보 교환**: BGP는 AS 간에 네트워크 프리픽스(prefix)와 경로 속성을 교환합니다. 이를 통해 각 AS는 자신이 도달 가능한 네트워크를 다른 AS에 알립니다.
* **경로 선택**: 다양한 경로 중 정책과 경로 속성에 따라 최적의 경로를 선택합니다.
* **연결성 유지**: 네트워크 변경이나 장애 발생 시에도 대체 경로를 통해 연결성을 유지합니다.

#### **BGP의 작동 원리**

* **피어링(Peering) 관계 수립**: 두 AS는 BGP 세션을 설정하여 경로 정보를 교환합니다.
* **라우트 애드버타이즈먼트(Route Advertisement)**: 각 AS는 자신이 도달 가능한 네트워크 프리픽스를 광고합니다.
* **경로 속성**: BGP는 다양한 경로 속성(예: AS\_PATH, NEXT\_HOP, MED 등)을 사용하여 경로를 평가하고 선택합니다.
* **정책 기반 라우팅**: AS는 자체 정책에 따라 특정 경로를 선호하거나 회피할 수 있습니다.

#### **BGP 메시지 타입**

* **OPEN**: BGP 세션을 시작하기 위한 메시지로, 초기 설정 정보를 교환합니다.
* **UPDATE**: 경로 정보를 광고하거나 철회하기 위한 메시지로, 네트워크 상태 변화를 반영합니다.
* **KEEPALIVE**: 세션 유지를 위한 주기적인 메시지로, 상대방의 생존 여부를 확인합니다.
* **NOTIFICATION**: 오류 발생 시 세션 종료를 알리는 메시지로, 문제 원인을 전달합니다.

***

### **인터넷 익스체인지 포인트(IXP)란 무엇인가**

IXP는 여러 AS나 네트워크 사업자들이 상호 간에 트래픽을 교환할 수 있도록 구축된 **물리적 인프라**입니다. IXP를 통해 네트워크는 직접적으로 피어링을 맺어 트래픽을 효율적으로 전달할 수 있으며, 이는 인터넷의 성능과 안정성을 향상시킵니다.

**IXP의 역할과 이점**

```
비용 절감: 트래픽을 직접 교환함으로써 상위 트랜싯 제공자에게 지불하는 비용을 절감합니다.
지연 시간 감소: 경로를 단축하여 패킷 전송의 지연 시간을 최소화합니다.
대역폭 효율성 향상: 고속 연결을 통해 대량의 트래픽을 처리할 수 있습니다.
네트워크 안정성 증가: 다중 경로를 확보하여 장애 발생 시 대체 경로를 제공합니다.
```

**IXP의 작동 방식**

```
스위치 패브릭(Switch Fabric): IXP는 고속 이더넷 스위치로 구성된 패브릭을 제공합니다.
피어링 계약: 참여 네트워크 간에 피어링 계약을 맺어 트래픽 교환을 합의합니다.
라우팅 설정: BGP를 통해 라우팅 정보를 교환하고 트래픽을 전달합니다.
```

**IXP의 유형**

```
공용 IXP: 다수의 네트워크가 참여하는 공개된 교환 지점으로, 중립적인 위치에서 운영됩니다.
사설 IXP: 특정 조직이나 네트워크 간에 구축된 전용 교환 지점으로, 제한된 접근성을 가집니다
```

#### **IXP의 발전**

**지역 인터넷 발전 촉진**: 지역별 IXP의 구축은 현지 트래픽의 지역 내 교환을 촉진하여 인터넷 품질을 향상시킵니다.

**콘텐츠 제공자와의 직접 연결**: CDN 사업자와의 피어링을 통해 사용자에게 빠른 콘텐츠 전송이 가능합니다.

**클라우드 서비스와의 연동**: 클라우드 서비스 제공자와의 직접 연결로 서비스 성능과 안정성을 향상시킵니다.

***

### **BGP 라우팅 정책과 경로 선택 과정**

**BGP의 경로 선택 기준**

BGP는 여러 경로 중 최적의 경로를 선택하기 위해 다음과 같은 기준을 순차적으로 적용합니다:

1. **선호도(Local Preference)**: 내부적으로 설정된 경로 선호도 값이 높은 경로를 선택합니다.
2. **AS\_PATH 길이**: AS 경로가 짧은 경로를 선호하여, 중간 AS를 적게 거치는 경로를 선택합니다.
3. **원본 타입(Origin Type)**: 경로 정보의 원본 타입에 따라 우선순위를 부여합니다.
4. **MED(Multi-Exit Discriminator)**: 인접 AS로부터 전달된 경로의 우선순위를 결정합니다.
5. **IGP 비용**: 내부 라우팅 프로토콜에 따른 경로 비용을 고려합니다.
6. **라우터 ID**: 위의 기준이 모두 동일할 경우 라우터 ID가 낮은 경로를 선택합니다.

**정책 기반 라우팅**

AS는 BGP의 경로 속성과 자체 정책을 활용하여 특정 경로를 선호하거나 회피할 수 있습니다. 예를 들어, 트래픽 비용을 절감하기 위해 무료 피어링 경로를 선호하거나, 보안상의 이유로 특정 AS를 거치는 경로를 회피할 수 있습니다.

**BGP의 확장과 보안 이슈**

**BGP 확장 기능**

* **MP-BGP(Multi-Protocol BGP)**: IPv4뿐만 아니라 IPv6, MPLS 등 다양한 프로토콜의 경로 정보를 교환할 수 있도록 확장된 버전입니다.
* **BGP 커뮤니티**: 경로에 추가 정보를 첨부하여 정책 적용을 용이하게 합니다.
* **BGP 플로우 스펙(Flow Specification)**: 트래픽 필터링 정책을 교환하여 DDoS 방어 등에 활용됩니다.

**BGP의 보안 문제**

BGP는 설계 당시 보안에 대한 고려가 부족하여 다음과 같은 보안 이슈가 있습니다:

* **라우트 하이재킹(Route Hijacking)**: 악의적인 AS가 잘못된 경로 정보를 광고하여 트래픽을 가로채거나 차단하는 공격입니다.
* **라우트 리플렉션(Route Reflection) 취약점**: 라우트 리플렉터를 통한 경로 정보의 확산으로 인한 보안 취약점이 존재합니다.
* **보안 대책**: RPKI(Resource Public Key Infrastructure), BGPsec 등 보안 프로토콜이 개발되어 BGP의 인증과 무결성을 강화하고 있습니다.

***

### **AS, BGP, IXP 간의 상호 관계**

<img src="../../../.gitbook/assets/file.excalidraw.svg" alt="" class="gitbook-drawing">

**AS와 BGP의 관계**

AS는 인터넷의 라우팅 도메인으로, BGP를 사용하여 다른 AS와 라우팅 정보를 교환합니다. BGP를 통해 AS는 자신이 도달 가능한 네트워크와 경로 정보를 광고하고, 다른 AS로부터 정보를 수신하여 최적의 경로를 결정합니다. 이를 통해 인터넷의 복잡한 경로 지도가 형성됩니다.

**BGP와 IXP의 관계**

IXP에서 네트워크들은 BGP를 통해 피어링을 설정하고 경로 정보를 교환합니다. BGP는 IXP 내에서 트래픽 교환을 위한 핵심 프로토콜로 작동하며, 효율적인 라우팅과 트래픽 전달을 가능하게 합니다.

**AS와 IXP의 관계**

AS는 IXP에 연결하여 다른 AS와 직접 트래픽을 교환할 수 있습니다. 이를 통해 상위 트랜싯 제공자를 거치지 않고도 효율적인 통신이 가능해지며, 인터넷의 지도를 더욱 촘촘하고 효율적으로 만듭니다.
