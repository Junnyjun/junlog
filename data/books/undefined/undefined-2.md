# 고급 기능

### **파이프라인(Pipelining)**

파이프라인 기능은 여러 Redis 명령어를 한번에 보내서 네트워크 왕복 시간을 줄이는 기능입니다. 파이프라인을 사용할 때는 클라이언트가 여러 명령어를 서버에 한 번에 보내고, 서버는 한 번에 응답합니다. 파이프라인에서는 **`pipeline`** 옵션을 사용하여 여러 명령어를 묶을 수 있습니다.

**옵션 및 기능**

* **`PIPELINE`**: 여러 명령어를 순차적으로 보내서 한 번에 처리하는 기능입니다.
* **`NOREPLY`**: 파이프라인 모드에서 명령어의 응답을 받지 않으려면 이 옵션을 사용할 수 있습니다. 예를 들어, `SET` 명령어를 보내고 응답을 기다리지 않도록 설정할 수 있습니다.
* **`MULTI/EXEC`**: 트랜잭션 모드에서 파이프라인과 함께 사용하여 여러 명령어를 하나의 실행 단위로 처리할 수 있습니다.

***

### **루아 스크립팅(Lua Scripting)**

레디스에서 루아 스크립트를 실행할 때 사용되는 기능으로, 복잡한 연산이나 조건을 처리할 수 있습니다. **`EVAL`** 명령어를 사용하여 루아 스크립트를 실행하며, 옵션을 통해 여러 동작을 제어할 수 있습니다.

**옵션 및 기능**

*   **`EVAL`**: 루아 스크립트를 실행하는 명령어로, 스크립트의 코드와 함께 키와 값을 인수로 전달합니다.

    ```bash
    EVAL "return redis.call('GET', KEYS[1])" 1 mykey
    ```
*   **`EVALSHA`**: `EVAL`의 대체 명령어로, 이미 로드된 루아 스크립트의 SHA1 해시 값을 사용하여 스크립트를 실행합니다. 대역폭을 절약하고 성능을 개선할 수 있습니다.

    ```bash
    EVALSHA <SHA1> 1 mykey
    ```
* **`SCRIPT LOAD`**: 루아 스크립트를 Redis 서버에 로드하여, 해시값을 반환합니다. 이후 `EVALSHA`를 사용하여 해당 스크립트를 실행할 수 있습니다.
* **`SCRIPT FLUSH`**: 레디스에서 로드된 모든 루아 스크립트를 삭제하는 명령어입니다. 관리자가 필요에 따라 사용합니다.

***

### **트랜잭션(Transaction)**

트랜잭션을 사용하면 여러 명령어를 하나의 묶음으로 처리할 수 있으며, 중간에 오류가 발생하면 전체 트랜잭션을 롤백할 수 있습니다. Redis의 트랜잭션은 **`MULTI`**, **`EXEC`**, **`DISCARD`** 등의 명령어로 제어됩니다.

**옵션 및 기능**

*   **`MULTI`**: 트랜잭션을 시작하는 명령어입니다. 이 명령어 뒤에 실행되는 모든 명령어는 큐에 쌓입니다.

    ```bash
    MULTI
    ```
*   **`EXEC`**: `MULTI` 명령어로 시작한 트랜잭션을 실행합니다. 큐에 쌓인 명령어들이 원자적으로 실행됩니다.

    ```bash
    EXEC
    ```
*   **`DISCARD`**: 트랜잭션 중에 명령어가 실패하면 이를 취소하고 큐를 비우는 명령어입니다.

    ```bash
    DISCARD
    ```
*   **`WATCH`**: 특정 키에 대한 변화를 감지하고, 트랜잭션을 실행하기 전에 해당 키가 변경되었으면 트랜잭션을 중단합니다. **낙관적 락**을 구현하는데 유용합니다.

    ```bash
    WATCH mykey
    ```
* **`UNWATCH`**: `WATCH`로 지정한 키의 감시를 중단합니다.

***

### **모듈(Modules)**

레디스 모듈은 레디스의 기본 기능을 확장할 수 있도록 해주는 기능입니다. 사용자 정의 자료형을 추가하거나 복잡한 처리를 위해 C 언어로 작성된 외부 모듈을 레디스 서버에 추가할 수 있습니다.

**옵션 및 기능**

*   **`MODULE LOAD`**: 외부 모듈을 Redis 서버에 로드하는 명령어입니다. 모듈 파일의 경로를 지정하여 로드합니다.

    ```bash
    MODULE LOAD /path/to/module.so
    ```
*   **`MODULE LIST`**: 로드된 모든 모듈을 확인할 수 있는 명령어입니다.

    ```bash
    MODULE LIST
    ```
*   **`MODULE UNLOAD`**: 로드된 모듈을 언로드하는 명령어입니다. 언로드가 불가능한 경우도 있기 때문에 주의해야 합니다.

    ```bash
    MODULE UNLOAD mymodule
    ```

***

### **키 공간 알림(Keyspace Notifications)**

키 공간 알림은 특정 키의 변화를 실시간으로 감지할 수 있는 기능입니다. 이 기능은 **`Pub/Sub`** 시스템을 사용하여, 이벤트가 발생할 때 알림을 제공합니다.

**옵션 및 기능**

*   **`notify-keyspace-events`**: 알림을 받을 이벤트 종류를 설정하는 디렉티브입니다. 키 변경, 만료, 제거 등 다양한 이벤트를 구독할 수 있습니다.

    ```bash
    notify-keyspace-events "K"
    ```
*   **`PSUBSCRIBE`**: 키 공간과 이벤트에 대한 알림을 구독하는 명령어입니다. 예를 들어, 키 `foo`가 변경될 때마다 알림을 받도록 설정할 수 있습니다.

    ```bash
    PSUBSCRIBE '__keyspace@0__:foo'
    ```
*   **`PUBLISH`**: 특정 키의 변화에 대한 알림을 보낼 때 사용되는 명령어입니다.

    ```bash
    PUBLISH "__keyspace@0__:foo" "set"
    ```

***

### **클라이언트 측 캐시(Client-Side Caching)**

클라이언트 측 캐시는 서버로의 요청을 줄여 성능을 개선하고, 서버와 클라이언트 간의 데이터 동기화를 관리하는 기능입니다.

**옵션 및 기능**

*   **`CLIENT TRACKING`**: 클라이언트 측 캐시를 활성화하는 명령어입니다. 이를 통해 서버는 어떤 키가 클라이언트에서 캐시되고 있는지 추적할 수 있습니다.

    ```bash
    CLIENT TRACKING ON
    ```
*   **`PREFIX`**: 캐시 추적할 키의 접두사를 지정합니다. 이 접두사에 해당하는 키들이 클라이언트 측 캐시로 저장됩니다.

    ```bash
    CLIENT TRACKING ON PREFIX "user:"
    ```
*   **`BCAST`**: 키 변경 시 다른 클라이언트로 무효화 메시지를 전송하는 방식입니다. 브로드캐스트 모드에서 사용됩니다.

    ```bash
    CLIENT TRACKING ON BCAST
    ```

